\documentclass{article}
\pdfpagewidth=8.5in
\pdfpageheight=11in

\usepackage{../ZUMreport}
\usepackage{times}
\usepackage{url}
\usepackage{xcolor}
\usepackage{polski}
\usepackage[polish]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[utf8]{luainputenc}
\usepackage[hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{subfig}
\usepackage{pgfplots}
\usepackage{paracol}
\usepackage{gensymb}

\urlstyle{same}
	
\title{Zaawansowane uczenie maszynowe\\ Założenia wstępne projektu}

\author{
Robert Wojtaś, Jakub Sikora
\affiliations
numery albumów: 283234, 283418 \\
\emails
robert.wojtas.stud@pw.edu.pl, jakub.sikora2.stud@pw.edu.pl
}

\newcommand{\todo}[1]{\textcolor{red}{\textbf{TO DO:} #1}}
\newcommand{\jsc}[1]{\textcolor{blue}{\textbf{JS:} #1}}
\newcommand{\rwc}[1]{\textcolor{green}{\textbf{RW:} #1}}

\begin{document}
\maketitle

\noindent \textbf{Temat projektu}: Grupowanie (G), \\
\textbf{Zestaw danych}: Dane FIFA 2019 Complete Player Dataset (Kaggle) -- grupowanie lub predykcja skuteczności zawodników.

\section{Cel projektu}
\label{sec:cel-projektu}
Celem projektu będzie zbadanie użyteczności algorytmów grupowania w~zadaniu dobierania optymalnej pozycji piłkarzy z~gry FIFA~19 na boisku. Umiejętności poszczególnych zawodników są opisane za pomocą szeregu parametrów, które mają za zadanie obrazować zdolności gry w~ataku, pomocy i~obronie. Zadaniem algorytmu grupowania będzie połączenie w~grupy zawodników o~podobnych umiejętnościach, tak aby na tej podstawie móc wnioskować o~ich optymalnej pozycji.

\section{Zbiór danych}
\label{sec:dane}

\subsection{Charakterystka zbioru danych}
\label{subsec:charakterystka}

W~projekcie wykorzystane zostaną dane ze zbioru \emph{FIFA 19 Complete Player Dataset}~\cite{fifa-dataset} z~serwisu \url{kaggle.com}. Każdy zawodnik posiada ponad 70 użytecznych atrybutów opisujących jego umiejętności gry w~piłkę nożną. Wśród nich znajdują się atrybuty opisujące m.in. kontrolę piłki, przyspieszenie czy celność strzałów z~dystansu. 

Większość atrybutów jest opisana za pomocą wartości całkowitych z~zakresu $[0, 99]$. Niektóre atrybuty zostały opisane liczbą całkowitą z~zakresu $[0,5]$. W~zestawie danych, pojawiły się atrybuty ciągłe opisujące wartość zawodnika, jego tygodniówkę, wzrost, wiek i~wagę oraz atrybuty kategoryczne opisujące preferowaną nogę (lewa lub prawa), typ budowy ciała oraz jego główną pozycję.

Każdemu zawodnikowi przypisany jest atrybut kategoryczny opisujący główną pozycję na boisku oraz 26 wskaźników numerycznych, określających jak dobry jest dany zawodnik na poszczególnych pozycjach.

Dodatkowo, zbiór danych został uzupełniony o~metadane opisujące samego zawodnika, takie jak numer na koszulce, nazwisko, link do zdjęcia, drużyna, narodowość czy międzynarodową reputację. 

\begin{figure}[t]
    \centering    
    \begin{tabular}{cc}
    \subfloat[\emph{Short Passing}]{
        \begin{tikzpicture}[thick, scale=0.4]
            \Huge
            \begin{axis}[ymin=0, area style]
                \addplot+[ybar interval,mark=no] plot coordinates { (0, 0) (5, 3) (10, 53) (15, 242) (20, 485) (25, 632) (30, 465) (35, 397) (40, 503) (45, 766) (50, 1350) (55, 2408) (60, 3553) (65, 3496) (70, 2309) (75, 1084) (80, 336) (85, 65) (90, 12) (95, 0) };
            \end{axis}
        \end{tikzpicture}
    } &
    \subfloat[\emph{Strength}]{
        \begin{tikzpicture}[thick, scale=0.4]
            \Huge
            \begin{axis}[ymin=0, area style]
                \addplot+[ybar interval,mark=no] plot coordinates { (0, 0) (5, 0) (10, 0) (15, 1) (20, 2) (25, 40) (30, 301) (35, 354) (40, 618) (45, 800) (50, 1121) (55, 2015) (60, 2631) (65, 3093) (70, 2810) (75, 2354) (80, 1182) (85, 539) (90, 294) (95, 4) };
            \end{axis}
        \end{tikzpicture}    
    } \\
    \subfloat[\emph{Agility}]{
        \begin{tikzpicture}[thick, scale=0.4]
            \Huge
            \begin{axis}[ymin=0, area style]
                \addplot+[ybar interval,mark=no] plot coordinates { (0, 0) (5, 0) (10, 1) (15, 11) (20, 108) (25, 201) (30, 682) (35, 667) (40, 639) (45, 805) (50, 1156) (55, 1813) (60, 2308) (65, 2770) (70, 2734) (75, 2216) (80, 1116) (85, 607) (90, 320) (95, 5) };
            \end{axis}
        \end{tikzpicture}
    } &
    \subfloat[\emph{GK Positioning}]{
        \begin{tikzpicture}[thick, scale=0.4]
            \Huge
            \begin{axis}[ymin=0, area style, ytick={0, 2000, 5000, 8000}]
                \addplot+[ybar interval, mark=no] plot coordinates { (0, 81) (5, 6337) (10, 7876) (15, 1831) (20, 4) (25, 1) (30, 3) (35, 3) (40, 31) (45, 88) (50, 227) (55, 326) (60, 460) (65, 450) (70, 251) (75, 127) (80, 51) (85, 11) (90, 1) (95, 0) };
            \end{axis}
        \end{tikzpicture}
    } \\

    \end{tabular}
    \caption{Przykładowe rozkłady wartości atrybutów z~podanego zbioru danych}
    \label{fig:rozklady-atrybutow}
\end{figure}

Na rysunku~\ref{fig:rozklady-atrybutow} zostały zaprezentowane przykładowe rozkłady wartości badanych atrybutów. W~głównej mierze, są to rozkłady normalne lub gruboogonowe. Ciekawy rozkład mają atrybuty opisujące umiejętności bramkarskie. Z~racji nietypowej specyfiki tej pozycji, atrybuty te mają rozkład dwumodalny. Wysoki lewy pik rozkładu opisuje zawodników z~pola, których umiejętności bramkarskie są niewielkie ale jest ich zdecydowanie więcej. Prawy niewielki pik opisuje rzeczywistych bramkarzy, którzy mają niewątpliwie większe umiejętności, jednak jest ich wyraźnie mniej. Obecność bramkarzy w~zestawie danych jest również jednym z~powodów dla którego część rozkładów ma gruby ogon po lewej stronie. 

\subsection{Przygotowanie atrybutów}
\label{subsec:atrybuty}

W~procesie przygotowania danych, należy zastanowić się które atrybuty należy pozostawić a które powinny zostać usunięte. Oprócz tego, wykorzystując wiedzę ekspercką na temat piłki nożnej można zastanowić się nad generacją nowych atrybutów. Kolejnym krokiem będzie transformacja danych do~postaci użytecznej do przeprowadzenia wnioskowania, poprzez uzupełnienie brakujących danych, skalowanie, normalizację i~zamianę atrybutów kategorycznych na numeryczne. Ostatecznie, należy określić które z~atrybutów będą traktowane jako obserwowalne, a~które jako ukryte.

Do zbioru danych dodane zostaną dodatkowe atrybuty wygenerowane na podstawie już istniejących oraz wiedzy eksperckiej. Takimi atrybutami mogą być wygenerowane cechy fizyczne przykładowo stosunek wagi do wzrostu lub stosunek przyspieszenia do prędkości maksymalnej.

Ze zbioru definitywnie należy usunąć atrybuty opisowe określające nieinteresujące nas cechy takie jak narodowość, aktualna drużyna, reputacja czy nazwisko. Dodatkowo, ze zbioru danych usunięte zostaną atrybuty opisujące umiejętność gry danego zawodnika na danej pozycji, ponieważ taka informacja znacząco upraszcza zadanie i~mija się z~celem projektu. W~przypadku pozostałych atrybutów należy przeprowadzić analizę korelacyjną, tak aby moć stwierdzić które atrybuty nie wnoszą dodatkowej informacji. Ostatecznie, aby móc grupować zawodników grających na podobnych pozycjach lecz o~różnych poziomiach umiejętności, wartości atrybutów zostaną przeskalowane względem ich średniej wartości.  

Jako atrybut ukryty, potraktowana zostania optymalna pozycja na boisku. W~celu przeprowadzenia analizy poprawności badanego algorytmu grupowania, zakładamy że pozycja na boisku zapisana w~zbiorze danych jest jego rzeczywistą optymalną pozycją. Atrybut ten jest niezwykle ciekawy do analizy, ponieważ można go analizować na dwóch poziomach:

\begin{itemize}
    \item na poziomie ogólnym 
        \begin{itemize}
            \item bramkarz,
            \item obrońca,
            \item pomocnik,
            \item napastnik,
        \end{itemize}
    \item na poziomie szczegółowym:
    \begin{itemize}
        \item bramkarz,
        \item środkowy obrońca, 
        \item lewy/prawy boczny obrońca
        \item lewy/prawy wahadłowy,
        \item pomocnik ofensywny,
        \item lewy/środkowy/prawy pomocnik,
        \item pomocnik defensywny,
        \item napastnik,
        \item lewy/prawy skrzydłowy.
    \end{itemize}
\end{itemize}

Oprócz tego, w~zależności od wyników grupowania, można spróbować zdefiniować bardziej wyrafinowane pozycje m.in.: 
\emph{mezzala}, \emph{mediano}, \emph{trequartista} czy libero.

\section{Badane algorytmy}
\label{sec:algorytmy}

\subsection{Algorytm k-średnich}
\label{subsec:kmeans}
Celem algorytmu $k$-średnich jest pogrupowanie danych na $k$ grup w~taki sposób, aby zminimalizować sumę kwadratów odległości punktów od wyznaczonych centroidów (środków) grup. W~języku R, algorytm ten można wywołać za pomocą polecenia \texttt{kmeans}. 

W~pierwszym kroku algorytmu należy dobrać liczbę poszukiwanych grup oraz przyporządkować w~sposób losowy wszystkie obserwacje do grup. Następnie, w~$i$-tym kroku należy obliczyć położenie centroidu dla każdej grupy i~dla każdego punktu zaktualizować przynależności do grupy. Algorytm kończy się gdy w~danym kroku nie została zmieniona żadna przynależność lub przekroczono maksymalną liczbę kroków.

Domyślnie polecenie \texttt{kmeans} do znalezienia centroidów korzysta z~metody Hartigana-Wonga, jednak możliwa jest zamiana leżącego u~podstaw algorytmu na algorytm MacQueena lub Lloyda-Forgyego.

Głównym parametrem algorytmu $k$-średnich jest liczba szukanych grup $k$. Liczbę tą podajemy $a priori$, przed uruchomieniem algorytmu. Jednym ze sposobów na odpowiedni dobór parametru $k$ jest przeszukiwanie zupełne w~rozsądnie dobranym przedziale i~znalezienie takiej wartości, przy której wykres całkowitej sumy kwadratów odległości w~zbiorze danych ulega wypłaszczeniu.

Największym problemem algorytmu $k$-średnich jest dobór początkowego podziału na grupy. Możliwymi sposobami są losowy wybór $k$ 
przykładów ze zbioru danych lub ręczne podanie zbioru centroidów początkowych.

\subsection{Aglomeracyjny algorytm grupowania hierarchicznego}
\label{subsec:hierarchical}
\jsc{tutaj Robercik opisz co masz}


\subsection{Algorytmy grupowania rozmytego}
\label{subsec:fuzzy}
Algorytmy grupowania rozmytego bazują na założeniu że pojedyncza obserwacja może równocześnie należeć do wielu grup. To jak bardzo przykład należy do danej grupy $v$, opisuje \emph{funkcja przynależności} $\mu_{v}(x)$, która może przyjmować wartości z~przedziału $[0,1]$. Dla pojedynczej obserwacji $x$ spełnione są następujące własności:

\begin{equation}
    \sum_{v=1}^{k} \mu_{v}(x)    
\end{equation}

\begin{equation}
    \forall{v} \quad \mu_{v}(x) \geq 0     
\end{equation}

Podejście rozmyte może potencjalnie dać więcej korzyści, biorąc pod uwagę temat projektu. W~nowoczesnym futbolu, co raz częściej możemy spotkać się z~sytuacją w~której zawodnicy muszą umieć grać na kilku (jak nie wszystkich) pozycjach równocześnie.

W~projekcie porównamy działanie dwóch algorytmów rozmytego grupowania: fuzzy C-means oraz FANNY.

Podstawowym algorytmem grupowania rozmytego jest rozszerzenie algorytmu $k$-średnich na zbiory rozmyte, znany w~literaturze jako rozmyte $k$-średnich lub fuzzy C-means.

Algorytm ten nie różni się wiele od wersji oryginalnej. Jedyną różnicą jest zmiana sposobu określania przynależności do grupy, zamiast szukania najbliższej grupy, obliczamy przynależność do wszystkich grup równocześnie. W~pierwszym kroku algorytmu należy dobrać liczbę poszukiwanych grup oraz przyporządkować w~sposób losowy początkowe wartości funkcji przynależności do wszystkich grup. Następnie, w~$i$-tym kroku należy obliczyć położenie centroidu dla każdej grupy, a~dalej dla każdego punktu zaktualizować funkcje przynależności do wszytkich grup. Algorytm kończy działanie w~momencie gdy wartości funkcji przynależności zmieniły się o~wartość mniejszą niż $\epsilon$ lub osiągnięta została maksymalna liczba kroków.

Algorytm rozmytych $k$-średnich został zaimplementowany w~pakiecie \texttt{e1017} jako funkcja \texttt{cmeans}. Parametrami wymagającymi strojenia jest liczba grup, funkcja odległości, maksymalna liczba iteracji oraz stopień rozmycia.

Drugim badanym przez nas algorytmem będzie algorymt FANNY opracowany przez Kaufmana i~Rousseeuwa~\cite{kaufman2009finding} a~rozszerzony przez Maechlera. Algorytm ten minimalizuje następującą funkcję celu:

\begin{equation}
    \sum_{v=1}^{k} \frac{\sum_{i=1}^{n}\sum_{j=1}^{n} \mu^{r}_{v}(x_{i}) \mu^{r}_{v}(x_{j}) d(x_{i}, x_{j})}{2 \sum_{j=1}^{n} \mu^{r}_{v}(x_{j})} 
\end{equation}

gdzie~$n$ oznacza liczbę obserwacji w~zbiorze danych, $k$~jest liczbą grup, $r$~jest \emph{wykładnikiem przynależności}, natomiast~$d(x_{i}, x_{j})$ jest wybraną funkcją niepodobieństwa przykładów~$x_{i}$~i~$x_{j}$.


Algorytm ten został zaimplementowany w~pakiecie \texttt{cluster} jako funkcja \texttt{fanny}. Parametrami tej funkcji są: liczba grup, wykładnik przynależności, funkcja odległości oraz maksymalna liczba iteracji.


\todo{ustalić kryteria lub algorytmy selekcji atrybutów obserwowalnych}

\todo{wybrać algorytmy grupowania i wskazać miary \textbf{niepodobieństwa} przykładów}

\todo{wskazać parametry wymagające strojenia}

\todo{plan badań}

\section{Miary}
\label{sec:miary}

\subsection{Miary podobieństwa}
\label{subsec:podobienstwo}
\todo{opisać miary podobieństwa: suma kwadratow, pierwiastek z sumy kwadratow (euklidesowa), manhattan}

\subsection{Miary jakości grupowania}
\label{subsec:jakosc}
\todo{ustalić procedury i kryteria oceny jakości}



\section{Otwarte kwestie}
\label{sec:otwarte-kwestie}
\todo{do zostawienia sposób opisu grup i charakteryzowania ich specyfiki na podstawie rozkładu wartości atrybutów}

\bibliographystyle{abbrv}
\bibliography{bibliography}

\end{document}